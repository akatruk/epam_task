name: Python application

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  Unit_test:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
  #   - name: download python
  #     run: | 
  #       python -m pip install --upgrade pip
  #       pip install flask yaml2 psycopg2
  #       sudo apt-get --yes install python3-psycopg2 curl
  #   - name: Run unittest
  #     run: |
  #       python test_show_result.py

  Login:
    runs-on: ubuntu-latest
    needs: Unit_test
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      -
        name: Login to Docker Hub
        uses: docker/login-action@v1
        with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}
      -
        name: Build and push
        uses: docker/build-push-action@v2
        with:
          context: .
          push: true
          tags: ${{ secrets.DOCKERHUB_USERNAME }}/epum_task004:latest

 

  # Push_docker:
  #   runs-on: ubuntu-latest
  #   needs: Login
  #   - name: Build and push
  #     uses: docker/build-push-action@v2
  #     with:
  #       context: .
  #       push: true
  #       tags: errbx/epam_task04:latest
